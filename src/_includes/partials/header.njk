<header class="relative z-40 isolate grid grid-cols-layout shadow-border bg-white {% if page.fileSlug === 'forsiden' %}shadow{% endif %}">

  <div class="relative z-10 text-white bg-deepblue-800 md:hidden col-full">
    <button class="flex items-center justify-center w-full gap-2 px-4 py-2 hover:bg-deepblue-700 focus:outline-none focus-visible:bg-deepblue-800 focus-visible:text-white" x-on:click="audienceDropdownOpen = !audienceDropdownOpen">
      <span>{{ menu.audience[0] }}</span>
      {{ '/src/_includes/svg/chevron-down.svg' | svgContents('w-4 h-4') | safe }}
    </button>
    <div class="absolute inset-x-0 px-4 mt-px top-full">
      <ul class="overflow-hidden text-gray-900 bg-white divide-y divide-gray-300 rounded shadow-xl ring-1 ring-gray-200" role="tablist" x-show="audienceDropdownOpen">
        {% for item in menu.audience %}
        <li role="tab" aria-selected="{{ 'true' if loop.index === 1 else 'false' }}" class="grid">
          <a href="#" class="py-2 px-3 border-l-4 hover:bg-gray-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-800 {{ 'border-blue-500' if loop.index === 1 else 'border-transparent' }}">
            {{ item }}
          </a>
        </li>
        {% endfor %}
      </ul>
    </div>
  </div>

  <nav class="flex items-center w-full gap-4 col-feature">
    {# Logo #}
    <button x-on:click="indexOpen = !indexOpen" class="text-[#C30000] hover:text-[#DE2E2E] block focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-800 py-2.5 px-2 -mx-2 rounded-sm">
      {{ '/src/_includes/svg/logo.svg' | svgContents('w-20 md:w-16 h-auto') | safe }}
      <span class="sr-only">NAV</span>
    </button>

    {# Audience #}
    <div class="self-stretch hidden px-6 md:grid">
      <ul class="flex justify-center gap-4 text-lg " role="tablist">
        {% for item in menu.audience %}
        <li role="tab" aria-selected="{{ 'true' if loop.index === 1 else 'false' }}" class="grid">
          <a href="#" class="focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-800 flex items-center px-1.5 pb-5 text-gray-900 border-b-4 pt-7 {{ 'border-blue-500 font-semibold' if loop.index === 1 else 'border-transparent hover:border-gray-300/75 opacity-70' }}">
            {{ item | replace('person', "") }}
          </a>
        </li>
        {% endfor %}
      </ul>
    </div>

    {# Menu Buttons #}

    {% set menuButtonClasses = "flex flex-col xs:flex-row items-center justify-center pt-2 pb-2.5 px-3 leading-none font-semibold xs:gap-1 text-blue-500 xs:rounded md:px-3 xs:text-lg  hover:bg-deepblue-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-800" %}

    <div class="flex items-end gap-2 ml-auto xs:py-2">
      <button class="{{ menuButtonClasses }}" x-on:click="notifyOpen = !notifyOpen, menuOpen = false" x-bind:class="notifyOpen && 'bg-deepblue-50'">
        <span class="relative">
          {{ '/src/_includes/svg/notification.svg' | svgContents('w-7 h-7') | safe }}
          <span class="absolute block w-2 h-2 bg-red-400 rounded-full top-1 ring-2 ring-red-100/50 -left-1"></span>
        </span>
        <span class="mt-px">Varsel</span>
      </button>
      <button class="{{ menuButtonClasses }}" type="button" x-on:click="menuOpen = !menuOpen, notifyOpen = false" x-bind:class="menuOpen && 'bg-deepblue-50'">
        <template x-if="!menuOpen">
          {{ '/src/_includes/svg/menusearch.svg' | svgContents('w-7 h-7 shrink-0 pointer-events-none') | safe }}
        </template>
        <template x-if="menuOpen">
          {{ '/src/_includes/svg/close.svg' | svgContents('w-7 h-7 shrink-0 pointer-events-none') | safe }}
        </template>
        <span class="mt-px">Meny</span>
      </button>
    </div>
  </nav>
</header>

{% include "partials/navigation.njk" %}
{% include "partials/notifications.njk" %}

{# Overlay #}
<button class="fixed inset-0 z-30 w-full h-full bg-black/30 " x-bind:class="(menuOpen || notifyOpen) ? 'animate-fade-in' : 'hidden'" x-on:click="menuOpen = false, notifyOpen = false" x-on:keyup.escape.window="menuOpen = false, notifyOpen = false"></button>
