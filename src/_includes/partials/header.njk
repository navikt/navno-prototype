{%- set audience = audienceOverride or menu.audience -%}

<div class="bg-gray-100 md:hidden px-clamp-gap">
  <ul class="flex justify-around flex-1 max-w-sm gap-2 mx-auto text-base">
    {%- for item in audience -%}
      <li class="grid">
        <a href="{{ item.href or '#' }}" class="focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-800 flex items-center pt-2 pb-1.5 border-b-3 {{ 'font-semibold border-blue-500' if activeRole === item.title else 'border-transparent fine:hover:border-gray-300' }}">
          {{ item.title }} {{ item.active }}
        </a>
      </li>
    {%- endfor -%}
  </ul>
</div>


<header class="relative z-10 grid bg-white isolate grid-cols-layout shadow-border">

  <nav class="flex items-center w-full gap-8 col-wide">
    {# Logo #}
    <a href="/" class="text-red-500 fine:hover:text-red-400 block focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-800 py-2.5 px-2 -mx-2 rounded-sm">
      {{ '/src/_includes/svg/logo.svg' | svgContents('w-[75px] h-auto') | safe }}
      <span class="sr-only">NAV</span>
    </a>

    {# Audience #}
    <div class="relative hidden md:px-5 md:self-stretch md:grid">
      <button class="flex items-center self-center justify-center gap-6 py-2.5 pl-3 pr-2 border border-gray-300 rounded fine:hover:bg-deepblue-100 fine:hover:border-deepblue-200 focus:outline-none md:hidden" x-on:click="audienceDropdownOpen = !audienceDropdownOpen">
      {%- if ('samarbeidspartner' in (page.url | string)) -%}
      <span>{{ audience[2].title }}</span>
      {%- elif ('arbeidsgiver' in (page.url | string)) -%}
      <span>{{ audience[1].title }}</span>
      {%- elif (not 'soknad-og-skjema-' in (page.url | string)) -%}
      <span>{{ audience[0].title }}</span>
      {%- endif -%}
        {{ '/src/_includes/svg/icons/chevron-down.svg' | svgContents('w-4 h-4') | safe }}
      </button>
      <div class="static flex flex-col">
        <ul class="flex justify-center flex-1 gap-4 pt-3 overflow-hidden text-lg" x-bind:class="audienceDropdownOpen ? 'grid' : 'flex'">
          {%- for item in audience -%}
            <li class="grid">
              <a href="{{ item.href or '#' }}" class="focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-800 flex items-center py-2 px-0.5 pb-4 text-gray-900 border-b-4 {{ 'border-blue-500 font-semibold' if activeRole === item.title else 'border-transparent fine:hover:border-gray-300/75 text-gray-700' }}">
                {{ item.title }} {{ item.active }}
              </a>
            </li>
          {%- endfor -%}
        </ul>
      </div>
    </div>

    {# Menu Buttons #}
    {%- set menuButtonClasses = "flex-0 flex-col sm:flex-row items-center justify-center py-2 pl-2.5 pr-3 leading-none font-semibold sm:gap-2.5 text-blue-500 sm:rounded sm:text-lg fine:hover:bg-deepblue-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-800" -%}

    <div class="flex items-end gap-0.5 ml-auto py-2 sm:py-4 whitespace-nowrap">
      <button class="flex {{ menuButtonClasses }}" type="button">
        <span class="relative">
          {{ '/src/_includes/svg/icons/menu.svg' | svgContents('w-6 h-6') | safe }}
        </span>
        <span class="mt-px">Meny</span>
      </button>
      <button class="hidden sm:flex {{ menuButtonClasses }}" type="button">
          {{ '/src/_includes/svg/icons/search.svg' | svgContents('w-6 h-6 shrink-0 pointer-events-none') | safe }}
        <span class="mt-px">SÃ¸k</span>
      </button>
      <button class="flex {{ menuButtonClasses }}" type="button">
          {{ '/src/_includes/svg/icons/login.svg' | svgContents('w-6 h-6 shrink-0 pointer-events-none') | safe }}
        <span class="mt-px">Logg inn</span>
      </button>
    </div>
  </nav>
</header>
